# Claude Deep Review — R21 (2026-02-13)

## 0. Review Scope & Nature

**本轮定位**: 实质性专利质量深度评审 + R28 CNKI/Wanfang 工件审查

**审查对象**:
1. 权利要求书 v2（patent/权利要求书_资源调度_v2.md）
2. 说明书 v2（patent/说明书_资源调度_v2.md）
3. 附图说明 v2（patent/附图说明_资源调度_v2.md）
4. Prior art 全套（RS-P01 v2 + CN top-3 + CNKI/Wanfang matrix + CNIPA archive）
5. 技术映射（technique_claim_mapping_v2）

**评审方法论**: 本轮逐条审视权利要求的新颖性与非显而易见性，交叉验证 prior art 准确性，识别专利文本结构性缺陷。前序轮次（R1-R20）偏重代码正确性验证，本轮回到专利核心问题。

**Verdict**: **Conditional PASS — 专利文本尚未达到提交标准，须修复 8 项关键缺陷后方可提交**

---

## 1. 测试确认（不变基线）

```
> python -m unittest discover -s prototype/tests -p "test_*.py" -v
Ran 75 tests in 0.603s → OK
> python qa/validate_scheduler_config.py → PASS
```

代码基线不变，75/75 测试通过。本轮评审聚焦专利文本与 prior art 质量。

---

## 2. 权利要求书 v2 实质性审查

### PATENT-ISSUE-1 (Critical) — 独立权利要求混入测试方法论

权利要求 1 包含 7 个技术特征，其中第 6）和第 7）项：

```
6) 当启用事件驱动真机重试时，要求同时满足安全目标与吞吐目标...
7) 当未满足所述双目标时，依据失败原因执行下一轮自适应参数调整...
```

**问题**：这两项描述的是**测试/验证方法**（如何验证调度器有效性），不是调度器本身的产品功能。用户使用该调度器时不需要"启用事件驱动真机重试"——这是开发者验证调度器效果的实验框架。

**对比**：没有任何已知专利将测试基础设施作为独立权利要求的必要技术特征。这会导致：
1. 审查员质疑：这是产品特征还是测试方法？
2. 竞争者规避：不使用这种测试方法即可规避侵权
3. 独立权利要求保护范围实际收窄

**建议**：
- 独立权利要求 1 应仅保留特征 1）-5），聚焦调度器核心机制
- 特征 6）-7）移入从属权利要求，作为"一种实施方式包括自适应参数调优模块"
- 或者将自适应重试重构为**产品特征**（"调度器根据运行结果自动调整阈值参数"）而非测试特征

### PATENT-ISSUE-2 (Critical) — 权利要求使用代码变量名而非技术特征描述

以下代码变量名直接出现在权利要求中：
- `emergency_ticks`、`preempted_total`、`completed`、`min_completed`（权利要求 1 第 6 项）
- `threshold_bias`、`adaptation_action`、`retry_reason`（权利要求 11-12）
- `low_signal_dynamic`、`missing_emergency_signal`、`insufficient_completion`（权利要求 9）
- `task_count`、`duration_sec`、`base_mem_mb`（权利要求 10）
- `ema_alpha`（权利要求 3）
- `max_scheduler_wall_sec`（权利要求 12）

**问题**：专利权利要求应使用技术特征描述语言，不是实现层面的 Python 变量名。虽然中国软件专利允许一定程度的技术术语，但上述写法过于实现化，可能导致：
1. 保护范围过窄（仅覆盖使用完全相同变量命名的实现）
2. 审查员要求修改表述
3. 专业性质疑

**建议**：
- `emergency_ticks > 0` → "紧急模式触发次数大于零"
- `threshold_bias` → "准入阈值偏置量"
- `low_signal_dynamic` → "动态信号不足"
- `task_count`、`duration_sec`、`base_mem_mb` → "任务数量、任务持续时长、任务基础内存占用量"

### PATENT-ISSUE-3 (High) — 独立权利要求 1 技术特征过多

7 个技术特征的独立权利要求跨越了两个不同的抽象层（调度机制 + 测试方法），使得：
1. 难以主张侵权（需同时证明 7 项全部被实施）
2. 过于具体，限制了后续修改空间
3. 混合了核心创新（特征 2-5）与辅助功能（特征 6-7）

**建议**：精简为 4-5 个核心特征，其余移入从属权利要求。

### PATENT-ISSUE-4 (High) — 系统权利要求 15 过于简略

权利要求 15 仅列举模块名称，没有描述模块间的数据流和交互关系。对比标准做法：

当前：
> 包括：资源监控模块、模式判定模块、准入控制模块、定向抢占模块、任务执行模块、事件审计模块和自适应重试控制模块

应改为：
> 包括：资源监控模块，用于周期采集...并输出资源快照至模式判定模块；模式判定模块，用于接收所述资源快照并执行双视图判定，将判定结果输出至准入控制模块和定向抢占模块；准入控制模块，用于...

模块间的数据流是系统权利要求的核心保护点。

---

## 3. 说明书 v2 实质性审查

### PATENT-ISSUE-5 (Critical) — 说明书严重不足

当前说明书仅 121 行（约 3 页）。一份可提交的中国软件发明专利说明书通常需要 15-30 页，须包含：

| 缺失项 | 严重程度 | 说明 |
|--------|----------|------|
| 摘要 | Critical | 中国专利申请必须有摘要（100-300 字） |
| 背景技术具体引用 | Critical | 当前只写"现有技术常见问题"，未引用任何具体专利号或论文 |
| 具体实施方式详细性 | High | 当前各子节仅 3-5 行，应有详细步骤、判断条件、数据流 |
| 多实施例 | High | 应有至少 2-3 个不同参数配置的实施例 |
| 数值流程演算 | High | 应有具体数字的步骤追踪（如：内存 80% → 判定 HIGH → 准入投影 85% → 阻断） |
| 与现有技术对比表 | Medium | 应有本方案与 K8s/Slurm 等的逐特征对比 |
| 附图详细描述 | Medium | 当前附图说明各仅 1 句话 |

**建议**：说明书需要扩写至少 5-10 倍，补充上述所有缺失项。

### PATENT-ISSUE-6 (Critical) — 背景技术无具体引证

当前背景技术：
```
现有技术常见问题包括：
1. 仅使用平滑指标判定，突发紧急状态响应滞后。
2. 批量任务同周期提交时...
```

**问题**：这些都是泛泛的问题描述，没有引用任何具体的现有技术。中国专利法要求背景技术部分引用相关的现有技术并说明其不足。

**应有格式**：
```
例如，中国专利 CN111736987B 公开了一种基于 GPU 空间共享的任务调度方法，
采用马尔可夫链估计任务执行时间并进行资源分配。然而，该方法仅关注 GPU 级别
的微观调度，未涉及 CPU/内存/GPU 多资源联合准入控制和紧急回收...

又如，Kubernetes Pod Priority and Preemption 机制
(https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/)
支持基于优先级的抢占调度，但不具备...
```

---

## 4. Prior Art 搜索方法论审查

### PATENT-ISSUE-7 (High) — 搜索方法存在系统性缺陷

#### 4.1 CNIPA 搜索实际未在 CNIPA 执行

搜索日志明确承认：
> "CNIPA web interface is JS-heavy and not automation-friendly in this tooling context"
> "Candidate identification and metadata extraction were done from public CN patent pages on Google Patents"

这意味着：
- 不是 CNIPA 检索，是 Google Patents 关键词检索
- 没有使用 IPC/CPC 分类号系统检索
- 没有使用专业检索工具（PatSnap、Derwent Innovation、Orbit Intelligence）
- 检索覆盖度无法保证

#### 4.2 缺失关键英语文献

以下高度相关的已发表工作**完全未被覆盖**：

| 文献 | 年份 | 相关性 | 为何重要 |
|------|------|--------|----------|
| Gandiva (OSDI 2018) | 2018 | **High** | GPU 集群调度 + 抢占 + 内省式资源管理 |
| Tiresias (NSDI 2019) | 2019 | **High** | GPU 作业调度 + 优先级抢占 |
| AntMan (OSDI 2020) | 2020 | **High** | 动态 GPU 内存管理 + 任务共存 |
| Pollux (OSDI 2021) | 2021 | **High** | 自适应资源管理 + 动态调整 |
| Linux OOM Killer | 持续 | **High** | 内存压力 → 评分 → 终止进程（与我们的抢占评分机制高度相似） |
| NVIDIA MIG/MPS | 持续 | **Medium** | GPU 分区与共享调度 |
| YARN CapacityScheduler | 持续 | **Medium** | 多资源准入控制 + 抢占 |

Linux OOM Killer 尤其值得关注：它使用 `oom_badness()` 函数根据内存使用量对进程评分并终止得分最高者——这与我们的 `resource_reclaim_score()` 归一化评分 + 定向终止机制有**直接的功能对应关系**。

#### 4.3 CN-RS-06 定性错误

我实际访问了 CN116719628B 的 Google Patents 页面，发现：
- 该专利描述的是**数据传输链路的并发任务调度**（数据库读写操作的链路分配）
- **不是**计算资源调度
- R26 claim-level 分析将其描述为"concurrent-task preemptive scheduling"并给出"Medium-High"风险，这是**误导性定性**
- 实际风险应为 **Low**（不同领域，不构成直接 prior art）

#### 4.4 CNKI/Wanfang 文献矩阵深度不足

6 篇文献中：
- NP-04 (LTE-A 载波聚合资源分配) — 完全不同的领域（电信）
- NP-03 (桌面网格自调度) — 过时且不同领域
- NP-05 (PPO 车间调度) — 不同的优化范式
- 仅 NP-01 和 NP-06 与计算资源调度直接相关

且 Codex 承认无法直接访问 CNKI：
> "Direct automated extraction from CNKI detail pages is limited in this environment"

这意味着 CNKI 检索实际上是通过万方间接完成的，缺少 CNKI 自身的检索覆盖。

---

## 5. 新颖性与非显而易见性诚实评估

### 5.1 逐特征新颖性分析

| 特征 | 权利要求 | 现有技术对应 | 新颖性评估 |
|------|----------|-------------|------------|
| 周期资源采样 | 1-1) | K8s kubelet、Borg、collectd、psutil | **无新颖性**（标准做法） |
| 双视图判定（raw+EMA） | 1-2) | 监控系统普遍区分即时值与趋势值 | **低新颖性**（显而易见的工程选择） |
| EMA 平滑 | 3 | 教科书级信号处理 | **无新颖性** |
| 迟滞阈值 | 2-3) | 控制理论标准做法 | **无新颖性** |
| 冷却周期 | 2-4) | 标准防抖/去抖动 | **无新颖性** |
| 同 tick 累计投影 | 1-3), 4 | 准入控制 + 运行预算跟踪（数据库连接池、线程池） | **低新颖性**（概念已知，具体实现有差异） |
| per-GPU 亲和投影 | 1-3), 5 | NVIDIA MIG/MPS、GPU 亲和调度 | **中等新颖性**（bound/unbound 分桶有一定特色） |
| 紧急阻断 | 1-4) | K8s node-pressure eviction、Linux OOM | **无新颖性** |
| 瓶颈定向抢占 | 1-4), 6 | 多资源抢占在 YARN/Mesos 中存在 | **低新颖性** |
| 归一化双目标评分 | 1-5), 8 | 多目标优化教科书方法，但具体公式有特色 | **中等新颖性** |
| GPU 亲和权重 | 7 | 特定权重体系(同卡>未绑>跨卡) | **中等新颖性** |
| 协同评分 | 代码 L806-808 | `mem_unit + gpu_unit + min(mem_unit, gpu_unit)` | **较高新颖性**（具体公式未见完全相同的先例） |
| 双目标回收停止 | 8 | 多资源回收目标在集群调度中存在 | **低新颖性** |
| 自适应重试 | 6-7, 9-12 | 这是测试方法，非产品特征 | **不适用**（不应作为权利要求） |

### 5.2 组合新颖性评估

**最强保护方向**（结合后可能具有非显而易见性）：
1. per-GPU bound/unbound 分桶准入投影（特征 5）
2. 归一化双目标抢占评分 + 协同加分（特征 5, 8, 代码 L806-808）
3. GPU 亲和权重梯度（特征 7）

**这三者的组合**确实构成了一个有特色的技术方案：在同一调度周期内，按 GPU 卡分桶进行准入投影，在紧急时基于瓶颈识别 + 归一化评分 + 亲和权重执行定向回收。这个组合在已检索的 prior art 中未见完全对应。

**但须注意**：
- 在没有 Gandiva、AntMan 等文献的 claim-level 分析之前，无法确认这个组合的非显而易见性
- Linux OOM Killer 的 `oom_badness` 评分机制与本项目的 `resource_reclaim_score` 在方法论上相似

### 5.3 授权概率估计（修正后）

| 场景 | 概率 | 条件 |
|------|------|------|
| 当前文本直接提交 | 15-25% | 说明书过薄，背景无引证，独立权利要求含测试方法 |
| 修复 8 项缺陷后提交 | 40-55% | 缩窄权利要求聚焦 GPU 亲和+归一化评分组合 |
| 修复 + 专业代理人优化后 | 55-70% | 代理人重构权利要求层次 + 扩写说明书 |
| 授权后抵御无效挑战 | 20-35% | 取决于最终授权范围的宽窄 |

---

## 6. R28 工件审查

### 6.1 CNKI/Wanfang 文献矩阵

| 检查项 | 状态 | 备注 |
|--------|------|------|
| 6 篇文献均有 URL | ✓ | |
| 文献类型标注（期刊/学位论文） | ✓ | |
| 相关性评级 | ✓ | 但 NP-04 不相关 |
| 差异化结论 | ✓ | 诚实标注"单一技术有先例" |
| CNKI 入口路径 | ✓ | 但未实际使用 CNKI 检索 |

### 6.2 CNIPA Legal Status Archive

| 检查项 | 状态 |
|--------|------|
| 3 篇 CN 专利状态归档 | ✓ |
| 申请号 + 优先权日 + 公开日 | ✓ |
| 法律状态信号 | ✓ |
| 诚实标注"工程级，非法律意见" | ✓ |
| 后续归档清单 | ✓ |

### 6.3 R28 整体

R28 在工程层面完成了 CNKI/Wanfang 和 CNIPA 归档的初步工作，但深度不足（详见 §4）。

---

## 7. Issue Status Update

| ID | Severity | 状态 | 说明 |
|----|----------|------|------|
| PATENT-ISSUE-1 | **Critical** | NEW | 独立权利要求混入测试方法论 |
| PATENT-ISSUE-2 | **Critical** | NEW | 权利要求使用代码变量名 |
| PATENT-ISSUE-3 | High | NEW | 独立权利要求技术特征过多 |
| PATENT-ISSUE-4 | High | NEW | 系统权利要求 15 过于简略 |
| PATENT-ISSUE-5 | **Critical** | NEW | 说明书严重不足（121 行 vs 需 15-30 页） |
| PATENT-ISSUE-6 | **Critical** | NEW | 背景技术无具体引证 |
| PATENT-ISSUE-7 | High | NEW | 搜索方法存在系统性缺陷 |
| PATENT-ISSUE-8 | High | NEW | CN-RS-06 定性错误（数据传输≠计算资源调度） |
| ISSUE-51 | Info | NARROWED | 工程级初步覆盖，仍需专业检索 |
| ISSUE-55 | Info | NARROWED | 工程级完成，法律级待定 |
| ISSUE-62 | Info | OPEN | data_model.md 编码 |
| ISSUE-63 | Info | OPEN | BOM 文件 |

---

## 8. 专利提交前必须修复的 8 项缺陷

按优先级排序：

### 必须修复（不修复则不应提交）

1. **[PATENT-ISSUE-5] 扩写说明书**：从 121 行扩展到 15-30 页，补充摘要、具体引证、详细实施例、数值流程演算
2. **[PATENT-ISSUE-6] 补充背景技术引证**：至少引用 3-5 项具体的现有技术（含专利号/论文/URL）并说明各自不足
3. **[PATENT-ISSUE-1] 重构独立权利要求**：移除测试方法论（特征 6-7），聚焦调度器核心机制
4. **[PATENT-ISSUE-2] 替换代码变量名**：用技术特征描述语言替代所有 Python 变量名

### 强烈建议修复

5. **[PATENT-ISSUE-3] 精简独立权利要求**：4-5 个核心特征，其余移入从属权利要求
6. **[PATENT-ISSUE-4] 充实系统权利要求**：补充模块间数据流描述
7. **[PATENT-ISSUE-7] 补充 prior art 覆盖**：至少覆盖 Gandiva、Linux OOM Killer 与 K8s scheduler 的 claim-level 分析
8. **[PATENT-ISSUE-8] 修正 CN-RS-06 定性**：降级为 Low 风险，补充说明实际领域差异

---

## 9. 建议的权利要求重构方向

### 重构后的独立方法权利要求（建议稿）

```
1. 一种面向计算设备的多资源动态调度方法，其特征在于，包括：
  1) 周期采集处理器、内存和图形处理器资源使用状态；
  2) 对所述资源使用状态执行双视图模式判定，紧急判定使用原始采样值，
     稳态判定使用经指数移动平均处理后的平滑值；
  3) 在非紧急模式下执行准入判定，维护按图形处理器卡分桶的显存投影预算
     和未绑定任务的保守投影预算，同一调度周期内每次准入成功后更新后续
     候选任务的投影基线；
  4) 在紧急模式下阻断新任务准入，识别瓶颈资源维度和热点图形处理器，
     对候选任务计算归一化资源回收评分，所述评分至少包含内存回收贡献和
     图形处理器回收贡献各自除以对应回收缺口后的归一化组合。
```

这样的独立权利要求：
- 聚焦调度器核心机制（4 个特征）
- 不含测试方法论
- 不含代码变量名
- 保护范围更宽（竞争者更难规避）
- 后续可通过从属权利要求覆盖亲和权重、协同评分、自适应调优等

---

## 10. Overall Assessment

**Conditional PASS** — R28 工件工程质量可接受，但**专利文本离提交标准有显著差距**。

**代码质量**: 优秀（75/75 tests, production-ready）
**实验证据**: 充分（R24 completed=7, 全 3 分支覆盖）
**专利文本**: **不合格**（4 个 Critical + 4 个 High 缺陷）
**Prior Art**: 初步覆盖但有系统性缺陷（缺英文文献、搜索方法非专业级）

**核心判断**：本项目的技术实现质量远超专利文档质量。代码是 production-ready 的，但专利文本是 draft-level 的。在当前状态下提交，大概率会收到多轮审查意见通知书，且最终保护范围可能被大幅收窄。

**建议下一步**：
1. 优先修复 PATENT-ISSUE-1/2/5/6（4 个 Critical）
2. 考虑聘请专利代理人参与权利要求重构
3. 补充英文 prior art 覆盖后再评估最终提交方案

---

*Reviewed by Claude Opus 4.6 — 2026-02-13*
*本轮评审采用实质性审查标准，不以工程完成度替代专利可授权性评估*

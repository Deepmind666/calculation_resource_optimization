# 权利要求书（资源调度方向，v2）
- Timestamp: 2026-02-13 11:40:00 +08:00
- 说明: 在 v1 基础上补充 R23“按失败原因分支的自适应重试机制”，并强化真机证据对应特征。

## 一、方法类权利要求

1. 一种面向计算设备的动态资源调度方法，其特征在于，由处理器执行并至少包括：  
1) 周期采集 CPU、内存、交换分区及 GPU 资源快照；  
2) 对所述资源快照执行双视图模式判定，其中紧急判定使用原始快照，稳态判定使用平滑快照；  
3) 在非紧急模式下，对待执行任务执行准入判定，且在同一调度周期内采用累计投影预算，所述累计投影预算至少包括内存、CPU、按 GPU 卡分桶预算和未绑定 GPU 预算；  
4) 在紧急模式下阻断新任务准入，并基于瓶颈资源维度执行定向抢占回收；  
5) 在所述定向抢占回收中，按照任务优先级、资源回收归一化评分和时间序进行排序，所述资源回收归一化评分至少包括内存回收贡献和 GPU 回收贡献；  
6) 当启用事件驱动真机重试时，要求同时满足安全目标与吞吐目标，所述安全目标为 `emergency_ticks > 0` 或 `preempted_total > 0`，所述吞吐目标为 `completed >= min_completed`；  
7) 当未满足所述双目标时，依据失败原因执行下一轮自适应参数调整，并输出可审计尝试轨迹。

2. 根据权利要求1所述的方法，其特征在于，所述双视图模式判定包括：  
1) 紧急判定依据原始快照中的内存占用比例、交换占用比例、可用内存和 GPU 显存占用比例；  
2) 稳态判定依据平滑快照；  
3) 模式退出采用迟滞阈值；  
4) 紧急模式退出后保留冷却周期。

3. 根据权利要求1所述的方法，其特征在于，所述平滑快照采用指数移动平均计算，平滑系数 `ema_alpha` 属于 `[0, 1]`。

4. 根据权利要求1所述的方法，其特征在于，所述同一调度周期累计投影预算在每次任务准入成功后立即更新，并用于同周期后续候选任务判定。

5. 根据权利要求1所述的方法，其特征在于，所述 GPU 准入判定在任务声明 `target_gpu_index` 时仅对目标卡执行显存投影，未声明目标卡的任务采用保守投影。

6. 根据权利要求1所述的方法，其特征在于，所述定向抢占回收包括热点 GPU 识别、亲和权重计算和双目标回收停止条件。

7. 根据权利要求6所述的方法，其特征在于，所述亲和权重至少满足：同卡绑定任务权重高于未绑定任务，未绑定任务权重高于跨卡绑定任务。

8. 根据权利要求6所述的方法，其特征在于，所述归一化评分由各资源维度回收贡献分别除以对应回收缺口后组合得到。

9. 根据权利要求1所述的方法，其特征在于，所述自适应参数调整至少包括：  
1) 当失败原因为 `insufficient_completion` 时，提高准入阈值并延长调度窗口；  
2) 当失败原因为 `low_signal_dynamic` 或 `missing_emergency_signal` 时，降低准入阈值并提升压力参数。

10. 根据权利要求9所述的方法，其特征在于，所述压力参数至少包括 `task_count`、`duration_sec`、`base_mem_mb` 中之一。

11. 根据权利要求9所述的方法，其特征在于，所述自适应参数调整使用阈值偏置变量 `threshold_bias`，并在每轮结束后按失败原因更新。

12. 根据权利要求1所述的方法，其特征在于，所述尝试轨迹至少记录 `threshold_bias`、`adaptation_action`、`retry_reason`、动态阈值与每轮调度窗口时长。

13. 根据权利要求1所述的方法，其特征在于，所述方法对终止失败任务执行超时逃逸移除，并记录失败与移除事件。

14. 根据权利要求1所述的方法，其特征在于，所述方法区分阻断事件计数与唯一任务阻断计数，且紧急模式下对 pending 任务逐条记录阻断事件。

## 二、系统类权利要求

15. 一种动态资源调度系统，其特征在于，包括：资源监控模块、模式判定模块、准入控制模块、定向抢占模块、任务执行模块、事件审计模块和自适应重试控制模块；  
其中所述自适应重试控制模块用于依据失败原因更新下一轮动态阈值与压力参数。

16. 根据权利要求15所述的系统，其特征在于，所述自适应重试控制模块输出包含 `threshold_bias` 与 `adaptation_action` 的可追溯审计记录。

## 三、存储介质类权利要求

17. 一种计算机可读存储介质，其上存储有计算机程序，所述程序在被处理器执行时实现权利要求1至14任一项所述的方法。

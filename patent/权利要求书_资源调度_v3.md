# 权利要求书（资源调度方向，v3）

- 时间戳：2026-02-13 21:30:00 +08:00
- 说明：本版本针对 R21 与 R23 评审缺陷重构，独立权利要求仅保留调度器产品核心机制，去除测试方法表述与代码变量命名。

## 一、方法类权利要求

1. 一种面向计算设备的多资源动态调度方法，其特征在于，包括如下步骤：  
1) 周期采集处理器资源、内存资源和图形处理器资源的使用状态，形成原始资源快照；  
2) 对所述原始资源快照执行双视图模式判定，其中紧急状态判定基于原始采样值，稳态状态判定基于经指数移动平均处理后的平滑采样值；  
3) 在非紧急状态下执行准入控制，维护同一调度周期内的累计资源投影预算，所述累计资源投影预算至少包括内存预算、处理器预算、按图形处理器卡分桶的显存预算以及未绑定图形处理器任务的保守预算，并在每次准入成功后更新后续候选任务的投影基线；  
4) 在紧急状态下阻断新任务准入，识别瓶颈资源维度和热点图形处理器，并对候选任务计算归一化资源回收评分，所述归一化资源回收评分至少包括内存回收贡献除以内存回收缺口与图形处理器回收贡献除以图形处理器回收缺口后的组合值；  
5) 基于任务优先级、所述归一化资源回收评分和任务启动时序执行定向抢占，直至达到紧急资源回收目标。  

2. 根据权利要求1所述的方法，其特征在于，所述双视图模式判定还包括迟滞退出机制和紧急冷却机制，以避免资源利用率在阈值附近抖动导致的模式频繁切换。

3. 根据权利要求1所述的方法，其特征在于，所述指数移动平均处理采用平滑系数，所述平滑系数取值范围为0至1，且在平滑系数等于1时退化为原始采样直通模式。

4. 根据权利要求1所述的方法，其特征在于，所述同一调度周期内的累计资源投影预算采用逐任务即时累加方式，每当一个候选任务被准入，后续候选任务均使用更新后的投影预算执行准入判定。

5. 根据权利要求1所述的方法，其特征在于，所述按图形处理器卡分桶的显存预算包括：  
1) 对声明目标图形处理器卡的绑定任务，仅在所述目标图形处理器卡上进行显存投影；  
2) 对未声明目标图形处理器卡的未绑定任务，将其显存需求以保守方式计入各图形处理器卡的准入风险评估。  

6. 根据权利要求5所述的方法，其特征在于，当候选任务声明的目标图形处理器卡不可用时，生成目标图形处理器不可用的阻断判定结果并记录审计事件。

7. 根据权利要求1所述的方法，其特征在于，所述定向抢占包括图形处理器亲和权重机制，所述图形处理器亲和权重机制至少满足：同卡绑定任务权重高于未绑定任务权重，未绑定任务权重高于跨卡绑定任务权重。

8. 根据权利要求1所述的方法，其特征在于，所述归一化资源回收评分在内存与图形处理器同时紧急时，采用内存归一化回收值与图形处理器归一化回收值的协同组合，以提高对双瓶颈同时缓解任务的优先回收概率。

9. 根据权利要求1所述的方法，其特征在于，所述定向抢占采用双目标回收停止条件，至少同时满足内存回收目标与图形处理器回收目标后停止本轮抢占。

10. 根据权利要求1所述的方法，其特征在于，所述阻断统计至少包括阻断事件总数和唯一阻断任务总数，且在紧急状态下对待执行队列中的每个任务均记录逐任务阻断事件。

11. 根据权利要求1所述的方法，其特征在于，所述方法还包括终止失败逃逸机制，当任务在预设终止超时时间内未被正常终止时，执行强制移除并记录任务停止失败事件与超时移除事件。

12. 根据权利要求1所述的方法，其特征在于，所述方法还包括自适应参数调优步骤：  
1) 根据连续运行统计信号识别重试原因类别；  
2) 根据所述重试原因类别调整下一调度窗口的准入阈值偏置量、任务数量参数、任务持续时长参数和任务基础内存占用参数中的至少一项；  
3) 输出包含调整动作和重试原因类别的可审计轨迹记录。  

13. 根据权利要求12所述的方法，其特征在于，所述自适应参数调优步骤对不同重试原因类别执行分支调节，其中在吞吐不足时采用阈值放宽并延长调度窗口，在紧急信号不足时采用阈值收紧并提高压力参数。

14. 根据权利要求1所述的方法，其特征在于，所述方法还包括任务级资源画像自校准步骤：根据已完成任务观测到的内存峰值、处理器峰值与图形处理器峰值更新任务画像，并使用所述任务画像修正后续同类任务的资源估算值。

## 二、系统类权利要求

15. 一种多资源动态调度系统，其特征在于，包括：  
1) 资源监控模块，用于周期采集处理器资源、内存资源和图形处理器资源的使用状态并输出原始资源快照；  
2) 模式判定模块，用于接收所述原始资源快照并执行双视图模式判定，将紧急判定结果与稳态判定结果输出至准入控制模块和定向抢占模块；  
3) 准入控制模块，用于在非紧急状态下执行同周期累计资源投影准入判定，输出准入结果并更新投影预算基线；  
4) 定向抢占模块，用于在紧急状态下识别瓶颈资源维度与热点图形处理器，计算候选任务归一化资源回收评分并执行抢占回收；  
5) 任务执行模块，用于执行准入任务、停止抢占任务并反馈运行状态；  
6) 事件审计模块，用于记录模式切换事件、任务阻断事件、任务启动事件、任务停止事件和参数调优事件；  
7) 参数调优模块，用于基于运行统计信号更新后续调度窗口的阈值偏置与负载参数；  
其中，所述资源监控模块、模式判定模块、准入控制模块、定向抢占模块、任务执行模块、事件审计模块和参数调优模块按数据流闭环连接，以实现紧急保护和吞吐保障的联合目标。

16. 根据权利要求15所述的系统，其特征在于，所述准入控制模块包括按图形处理器卡分桶预算单元和未绑定任务保守预算单元，且所述定向抢占模块包括热点卡识别单元、归一化评分单元和双目标回收停止单元。

## 三、存储介质类权利要求

17. 一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现权利要求1至14任一项所述的方法，或用于驱动权利要求15或16所述的系统运行。
